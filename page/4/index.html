
 <!DOCTYPE HTML>
<html lang="zh-cn">
<head>
  <meta name="google-site-verification" content="0dfpYjYP37p5-odIMIJFaSXqgC0czlP_NcS4CoK8iew" />
  <meta charset="UTF-8">
  
    <title>艾瑞克</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="ericwang">
    

    
    <meta name="description" content="精通java,php,c,c++,andriod,ios等单词的拼写,精通windows,linux,osx等系统的开关机,求一份扫地的工作">
<meta property="og:type" content="website">
<meta property="og:title" content="艾瑞克">
<meta property="og:url" content="http://magnetoeric.github.io/page/4/index.html">
<meta property="og:site_name" content="艾瑞克">
<meta property="og:description" content="精通java,php,c,c++,andriod,ios等单词的拼写,精通windows,linux,osx等系统的开关机,求一份扫地的工作">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="艾瑞克">
<meta name="twitter:description" content="精通java,php,c,c++,andriod,ios等单词的拼写,精通windows,linux,osx等系统的开关机,求一份扫地的工作">

    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="艾瑞克" title="艾瑞克"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="艾瑞克">艾瑞克</a></h1>
				<h2 class="blog-motto">艾瑞克的小站</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:magnetoeric.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/01/16/docker_02/" title="docker laravel dev环境搭建" itemprop="url">docker laravel dev环境搭建</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ericwang" target="_blank" itemprop="author">ericwang</a>
		
  <p class="article-time">
    <time datetime="2016-01-16T06:28:00.000Z" itemprop="datePublished"> Published 2016-01-16</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>mbp上搭建了docker环境，就完完整整的写个docker for laravel的dev环境吧<br>(鉴于问题很多  就不贴具体代码了)<br>有docker环境的直接安装应该就可以了。<br>需要配置下本地的laravel目录，这样就可以把laravel目录挂载到docker 里了，就可以在本机里修改代码，docker中也会更新。<br>使用过程也碰到一些坑：</p>
<ul>
<li>docker-machine重启vm后，vm内所有的东西全都没了！！这是最坑的，本来已经写好了，结果重启了一下，什么都没了，2天白干了，索性又花了一天时间去重写了一遍，效率还可以。</li>
<li>docker的挂载有些问题，挂载后的目录在docker里看的怪怪的，比如我挂载了一个/data目录,ls -al /data data的用户竟然是10000，让我很迷茫，后来发现，实际上是docker－machine里docker用户的uid</li>
<li>默认的ubuntu 14.04里包很少，而我使用的编译安装，所以很多时候会找不到依赖，然后就要重新build。以前写的时候并没有很在意，最近发现，其实是有技巧的，docker是有类似缓存的，只要在dockerfile最下新增内容，实际上之前build成功的地方是有commit的，直接使用cache</li>
</ul>
<p>从前并不认为经验很重要，这几天感悟很深，2天写的东西丢失之后，用了仅仅半天就搞定了。由此可见，做过和没做过是有差别的，用心做和做过也是有差别的。<br>这个环境有很多需要改进的地方，比如脚本路径有些问题；docker的基础环境，个人觉得应该是一层一层build出来的，而不是简单的像我这样，一次性安装完；</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/docker/">docker</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/php/">php</a><a href="/tags/docker/">docker</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/01/13/books_02/" title="PHP核心技术与最佳实践" itemprop="url">PHP核心技术与最佳实践</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ericwang" target="_blank" itemprop="author">ericwang</a>
		
  <p class="article-time">
    <time datetime="2016-01-13T07:17:00.000Z" itemprop="datePublished"> Published 2016-01-13</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>花了点时间看书，收获很大，扩展也是真正从这里开始学习的。<br><a href="http://book.douban.com/subject/20370984/" target="_blank" rel="external">豆瓣读书</a><br><a href="http://pan.baidu.com/s/1gehHaZD" target="_blank" rel="external">mobi格式下载</a><br>这本书的知识面还是很广的，但是深度还是不够，毕竟也不能全部深入介绍。<br>有些地方还有错误，细心去实践时候会发现问题，比如sql优化部分，like %xxx 这类sql是无法优化的，作者竟然还列举了优化方法。。。<br>但是回顾整部书，作为想在php方向突破瓶颈的人，还是值得一看的</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/books/">books</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/php/">php</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/01/12/laravel/" title="laravel 的一些吐槽" itemprop="url">laravel 的一些吐槽</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ericwang" target="_blank" itemprop="author">ericwang</a>
		
  <p class="article-time">
    <time datetime="2016-01-12T14:02:00.000Z" itemprop="datePublished"> Published 2016-01-12</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>最近在做业务项目迁移，把ec的代码迁移到laravel中，<br>为什么选用laravel，我也不知道(也不是我做选型)。其他的框架也没太多接触过，都是跑跑hello world，看的多一点的算是yaf了，不过个人理解，yaf没有orm，完全就是个vc框架，没有model层。需要自己去扩展，但是眼前项目很紧，明显不能这么用。以前用的框架是自己公司内部使用的，虽然思想的都不错，但是随便使用。<br>因为是公司内部物流系统，所以ui直接都是后端人员开发，ui框架选用的semantic，对于我这种不熟悉css，js的人来说也还不错，毕竟有文档，复制粘贴，大体的页面也就出来了。<br>但是开发过程中，还是想吐槽一下laravel。<br>1.最想吐槽的就是它的配置，放到.env里，每行其实就是个键值对，通过config目录下的配置读取，把这些配置替换过去，<br>但是我的项目配置不可能放在项目里啊，这是最基本的需求！因为不能对代码做入侵，所以可以在app初始化的时候，去set到外围目录里。为什么要set到外围目录？很简单，因为配置本就应该和代码分离，这样开发环境就能和线上环境区分出来了。但是这样远远不够，作为配置，很多项目是重复使用同一配置的，那就公用起来，做为每个项目不同的部分，也要区分出来，所以配置就成为了一个配置中心。以前在使用java开发时，比较简单，用的是superdiamond作为配置中心，公用的部分完全可以共用，独立的部分也不会被干扰。但是php显然不行，作为以进程为模型的语言，不可能每处理一个请求的时候就去读一遍配置，而应该是读取本地的某个固定目录的php文件，将配置载入。一旦配置发生改变（比如 redis迁移，mysql迁移，域名变更等）不需要一台一台地去更新配置，而是直接更新发布机的配置文件，直接发布到各机器上，这种方式可以使用ansible去做，Jenkins也可以做。也有自己去实现的，比如在每台机器上安装一个客户端，然后定时去和中心机器上的文件做对比，有不同就更新。想到的也就推模式和拉模式两种方式。<br>2.接下来就是blade模板，关于这个模板，文档实在是太少了，在页面上做变量嵌套的时候总是出问题，也无从查起，只能换种方式去做<br>3.log 这个就不多说了，实用的log并不多,php中的exception和fatal error是俩概念，无从和java的exception比拟。需要一个日志收集系统，去收集log，做分析。elk在这方面应该很强大，zabbix应该也可以。<br>4.分页，虽然可以自己实现，但是想短时间内做一个美观的无错误逻辑的，还是要花时间的。虽然这个在文档上有，但是用下来才发现，是给bootstrap模板使用的！一万个草泥马奔腾而过，然后github上找到了一份，还挺好用，虽然是个简单的实现。代码不贴了，在<a href="https://github.com/Landish/Pagination" target="_blank" rel="external">这里</a>,感谢开源。因为想尽量保证少量的依赖包，所以直接拷贝到文件里了。<br>先吐槽这些吧，吐槽归吐槽，laravel也有很多优点，比如依赖注入，validation，orm等等，很方便，不多说了</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/php/">php</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/php/">php</a><a href="/tags/laravel/">laravel</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/01/04/do_while/" title="do{...}while(0)的意义和用法" itemprop="url">do{...}while(0)的意义和用法</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ericwang" target="_blank" itemprop="author">ericwang</a>
		
  <p class="article-time">
    <time datetime="2016-01-04T13:23:35.000Z" itemprop="datePublished"> Published 2016-01-04</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>在尝试写扩展时，阅读到了这样类似的代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#define ZVAL_BOOL(z, b) do &#123;		\</div><div class="line">		zval *__z = (z);			\</div><div class="line">		Z_LVAL_P(__z) = ((b) != 0);	\</div><div class="line">		Z_TYPE_P(__z) = IS_BOOL;	\</div><div class="line">	&#125; while (0)</div></pre></td></tr></table></figure></p>
<p>好奇怪，明明是只做一次运算，为何要使用do{}while(0)的方式<br>google一下，涨了很多姿势<br>接下来的大部分部分参考<a href="http://www.spongeliu.com/415.html" target="_blank" rel="external">do{…}while(0)的意义和用法</a></p>
<p>linux内核和其他一些开源的代码中，经常会遇到这样的代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">do&#123;</div><div class="line"> ...</div><div class="line">&#125;while(0)</div></pre></td></tr></table></figure></p>
<p>总结起来这样写主要有以下几点好处：</p>
<p>1、辅助定义复杂的宏，避免引用的时候出错：</p>
<p>举例来说，假设你需要定义这样一个宏：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#define DOSOMETHING()\</div><div class="line">               foo1();\</div><div class="line">               foo2()</div></pre></td></tr></table></figure></p>
<p>这个宏的本意是，当调用DOSOMETHING()时，函数foo1()和foo2()都会被调用。但是如果你在调用的时候这么写：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">if(a&gt;0)</div><div class="line">    DOSOMETHING();</div></pre></td></tr></table></figure></p>
<p>因为宏在预处理的时候会直接被展开，你实际上写的代码是这个样子的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">if(a&gt;0)</div><div class="line">    foo1();</div><div class="line">foo2();</div></pre></td></tr></table></figure></p>
<p>这就出现了问题，因为无论a是否大于0，foo2()都会被执行，导致程序出错。</p>
<p>那么仅仅使用{}将foo1()和foo2()包起来行么？</p>
<p>我们在写代码的时候都习惯在语句右面加上分号，如果在宏中使用{}，代码里就相当于这样写了：“{…};”，展开后就是这个样子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">if(a&gt;0)</div><div class="line">&#123;</div><div class="line">    foo1();</div><div class="line">    foo2();</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>所以碰到这种调用宏:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">if (a&gt;0)</div><div class="line">     DOSOMETHING();</div><div class="line">else</div><div class="line">     DOOTHERTHING();</div></pre></td></tr></table></figure></p>
<p>会被扩展成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">if (a&gt;0) &#123;</div><div class="line">    foo1();</div><div class="line">    foo2();</div><div class="line">&#125;;</div><div class="line">else</div><div class="line">    DOOTHERTHING(wolf);</div></pre></td></tr></table></figure></p>
<p>这样不会编译通过。所以，很多人才采用了do{…}while(0);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">#define DOSOMETHING() \</div><div class="line">        do&#123; \</div><div class="line">          foo1();\</div><div class="line">          foo2();\</div><div class="line">        &#125;while(0)\</div><div class="line">    </div><div class="line">...</div><div class="line"> </div><div class="line">if(a&gt;0)</div><div class="line">    DOSOMETHING();</div><div class="line"> </div><div class="line">...</div></pre></td></tr></table></figure>
<p>这样，宏被展开后，才会保留初始的语义。GCC提供了Statement-Expressions用以替代do{…}while(0); 所以你也可以这样定义宏：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#define DOSOMETHING() (&#123;\</div><div class="line">        foo1(); \</div><div class="line">        foo2(); \</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>2、避免使用goto对程序流进行统一的控制：</p>
<p>有些函数中，在函数return之前我们经常会进行一些收尾的工作，比如free掉一块函数开始malloc的内存，goto一直都是一个比较简便的方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">int foo()</div><div class="line">&#123;</div><div class="line">    somestruct* ptr = malloc(...);</div><div class="line"> </div><div class="line">    dosomething...;</div><div class="line">    if(error)</div><div class="line">    &#123;</div><div class="line">        goto END;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    dosomething...;</div><div class="line">    if(error)</div><div class="line">    &#123;</div><div class="line">        goto END;</div><div class="line">    &#125;</div><div class="line">    dosomething...;</div><div class="line"> </div><div class="line">END:</div><div class="line">    free(ptr);</div><div class="line">    return 0;</div><div class="line"> </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>由于goto不符合软件工程的结构化，而且有可能使得代码难懂，所以很多人都不倡导使用，那这个时候就可以用do{}while(0)来进行统一的管理：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">int foo()</div><div class="line">&#123;</div><div class="line"> </div><div class="line">    somestruct* ptr = malloc(...);</div><div class="line"> </div><div class="line">    do&#123;</div><div class="line">        dosomething...;</div><div class="line">        if(error)</div><div class="line">        &#123;</div><div class="line">            break;</div><div class="line">        &#125;</div><div class="line"> </div><div class="line">        dosomething...;</div><div class="line">        if(error)</div><div class="line">        &#123;</div><div class="line">            break;</div><div class="line">        &#125;</div><div class="line">        dosomething...;</div><div class="line">    &#125;while(0);</div><div class="line"> </div><div class="line">    free(ptr);</div><div class="line">    return 0;</div><div class="line"> </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里将函数主体使用do()while(0)包含起来，使用break来代替goto，后续的处理工作在while之后，就能够达到同样的效果。</p>
<p>3、避免空宏引起的warning</p>
<p>内核中由于不同架构的限制，很多时候会用到空宏，在编译的时候，空宏会给出warning，为了避免这样的warning，就可以使用do{}while(0)来定义空宏：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#define EMPTYMICRO do&#123;&#125;while(0)</div></pre></td></tr></table></figure>
<p>4、定义一个单独的函数块来实现复杂的操作：</p>
<p>当你的功能很复杂，变量很多你又不愿意增加一个函数的时候，使用do{}while(0);，将你的代码写在里面，里面可以定义变量而不用考虑变量名会同函数之前或者之后的重复。</p>
<p>理解了这个do{…}while(0),一切豁然开朗。<br>发现ZVAL_RESOURCE,ZVAL_STRING,ZVAL_ZVAL等宏也都是使用的do{}while(0)的形式,ZVAL_DOUBLE,ZVAL_LONG等并没有使用,个人理解ZVAL_BOOL这样定义宏属于第一种情况。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C/">C</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/C/">C</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/01/04/c/" title="C指针" itemprop="url">C指针</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ericwang" target="_blank" itemprop="author">ericwang</a>
		
  <p class="article-time">
    <time datetime="2016-01-04T11:59:00.000Z" itemprop="datePublished"> Published 2016-01-04</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>最近深入学习写扩展，发现C功底太弱了，也印证了那句话，出来混迟早要还的。<br>大学里因为不喜欢指针，放弃了C转战java，结果到现在，也只有自己给自己填坑了。<br>所以找了些文章充实一下吧。<br>本文转自<a href="http://www.cnblogs.com/wchhuangya/archive/2009/12/24/1631121.html" target="_blank" rel="external">C指针</a></p>
<h2 id="第一章-指针的概念"><a href="#第一章-指针的概念" class="headerlink" title="第一章 指针的概念"></a>第一章 指针的概念</h2><p>指针是一个特殊的变量，它里面存储的数值被解释成为内存里的一个地址。 </p>
<p>要搞清一个指针需要搞清指针的四方面的内容：指针的类型，指针所指向的类型，指针的值或者叫指针所指向的内存区，还有指针本身所占据的内存区。让我们分别说明。<br>先声明几个指针放着做例子：<br>例一：<br>(1)int <em>ptr;<br>(2)char </em>ptr;<br>(3)int <em>*ptr;<br>(4)int (</em>ptr)[3];<br>(5)int <em>(</em>ptr)[4]; </p>
<ol>
<li><p>指针的类型。<br>从语法的角度看，你只要把指针声明语句里的指针名字去掉，剩下的部分就是这个指针的类型。这是指针本身所具有的类型。让我们看看例一中各个指针的类型：<br>(1)int <em>ptr; //指针的类型是int </em><br>(2)char <em>ptr; //指针的类型是char </em><br>(3)int <strong>ptr; //指针的类型是 int </strong><br>(4)int (<em>ptr)[3]; //指针的类型是 int(</em>)[3]<br>(5)int <em>(</em>ptr)[4]; //指针的类型是 int <em>(</em>)[4]<br>怎么样？找出指针的类型的方法是不是很简单？ </p>
</li>
<li><p>指针所指向的类型。<br>当你通过指针来访问指针所指向的内存区时，指针所指向的类型决定了编译器将把那片内存区里的内容当做什么来看待。从语法上看，你只须把指针声明语句中的指针名字和名字左边的指针声明符<em>去掉，剩下的就是指针所指向的类型。例如：<br>(1)int </em>ptr; //指针所指向的类型是int<br>(2)char <em>ptr; //指针所指向的的类型是char<br>(3)int **ptr; //指针所指向的的类型是 int </em><br>(4)int (<em>ptr)[3]; //指针所指向的的类型是 int()[3]<br>(5)int </em>(<em>ptr)[4]; //指针所指向的的类型是 int </em>()[4]<br>在指针的算术运算中，指针所指向的类型有很大的作用。指针的类型(即指针本身的类型)和指针所指向的类型是两个概念。当你对C越<br>来越熟悉时，你会发现，把与指针搅和在一起的”类型”这个概念分成”指针的类型”和”指针所指向的类型”两个概念，是精通指针的关键点之一。我看了不少书，发现有些写得差的书中，就把指针的这两个概念搅在一起了，所以看起书来前后矛盾，越看越糊涂。 </p>
</li>
<li><p>指针的值，或者叫指针所指向的内存区或地址。<br>指针的值是指针本身存储的数值，这个值将被编译器当作一个地址，而不是一个一般的数值。在32位程序里，所有类型的指针的值都是一个32位整数，因为32位程序里内存地址全都是32位长。指针所指向的内存区就是从指针的值所代表的那个内存地址开始，长度为si<br>zeof(指针所指向的类型)的一片内存区。以后，我们说一个指针的值是XX，就相当于说该指针指向了以XX为首地址的一片内存区域；我们说一个指针指向了某块内存区域，就相当于说该指针的值是这块内存区域的首地址。指针所指向的内存区和指针所指向的类型是两个完全不同的概念。在例一中，指针所指向的类型已经有了，但由于指针还未初始化，所以它所指向的内存区是不存在的，或者说是无意义的。以后，每遇到一个指针，都应该问问：这个指针的类型是什么？指针指向的类型是什么？该指针指向了哪里？ </p>
</li>
<li><p>指针本身所占据的内存区。<br>指针本身占了多大的内存？你只要用函数sizeof(指针的类型)测一下就知道<br>了。在32位平台里，指针本身占据了4个字节的长度。<br>指针本身占据的内存这个概念在判断一个指针表达式是否是左值时很有用。 </p>
</li>
</ol>
<h2 id="第二章-指针的算术运算"><a href="#第二章-指针的算术运算" class="headerlink" title="第二章 指针的算术运算"></a>第二章 指针的算术运算</h2><p>指针可以加上或减去一个整数。指针的这种运算的意义和通常的数值的加减运算的意义是不一样的。例如：<br>例二：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">char a[20]; </div><div class="line">int *ptr=a; </div><div class="line">... </div><div class="line">... </div><div class="line">ptr++;</div></pre></td></tr></table></figure></p>
<p>在上例中，指针ptr的类型是int*,它指向的类型是int，它被初始化为指向整形变量a。接下来的第3句中，指针ptr被加了1，编译器是这样处理的：它把指针ptr的值加上了sizeof(int)，在32位程序中，是被加上了4。由于地址是用字节做单位的，故ptr所指向的地址由原来的变量a的地址向高地址方向增加了4个字节。由于char类型的长度是一个字节，所以，原来ptr是指向数组a的第0号单元开始的四个字节，此时指向了数组a中从第4号单元开始的四个字节。我们可以用一个指针和一个循环来遍历一个数组，看例子：<br>例三：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">int array[20]; </div><div class="line">int *ptr=array; </div><div class="line">... </div><div class="line">//此处略去为整型数组赋值的代码。 </div><div class="line">... </div><div class="line">for(i=0;i&lt;20;i++) </div><div class="line">&#123; </div><div class="line">(*ptr)++; </div><div class="line">ptr++； </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这个例子将整型数组中各个单元的值加1。由于每次循环都将指针ptr加1，所以每次循环都能访问数组的下一个单元。<br>再看例子：<br>例四：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">char a[20]; </div><div class="line">int *ptr=a; </div><div class="line">... </div><div class="line">... </div><div class="line">ptr+=5;</div><div class="line">``` </div><div class="line">在这个例子中，ptr被加上了5，编译器是这样处理的：将指针ptr的值加上5乘sizeof(int)，在32位程序中就是加上了5乘4=20。由于地址的单位是字节，故现在的ptr所指向的地址比起加5后的ptr所指向的地址来说，向高地址方向移动了20个字节。在这个例子中，没加5前的ptr指向数组a的第0号单元开始的四个字节，加5后，ptr已经指向了数组a的合法范围之外了。虽然这种情况在应用上会出问题，但在语法上却是可以的。这也体现出了指针的灵活性。如果上例中，ptr是被减去5，那么处理过程大同小异，只不过ptr的值是被减去5乘sizeof(int)，新的ptr指向的地址将比原来的ptr所指向的地址向低地址方向移动了20个字节。 </div><div class="line"></div><div class="line">总结一下，一个指针ptrold加上一个整数n后，结果是一个新的指针ptrnew,ptrnew的类型和ptrold的类型相同，ptrnew所指向的类型和ptrold所指向的类型也相同。ptrnew的值将比ptrold的值增加了n乘sizeof(ptrold所指向的类型)个字节。就是说,ptrnew所指向的内存区将比ptrold所指向的内存区向高地址方向移动了n乘sizeof(ptrold所指向的类型)个字节。一个指针ptrold减去一个整数n后，结果是一个新的指针ptrnew，ptrnew的类型和ptrold的类型相同，ptrnew所指向的类型和ptrold所指向的类型也相同。ptrnew的值将比ptrold的值减少了n乘sizeof(ptrold所指向的类型)个字节，就是说 ，ptrnew所指向的内存区将比ptrold所指向的内存区向低地址方向移动了n乘sizeof(ptrold所指向的类型)个字节。 </div><div class="line"></div><div class="line">第三章 运算符号&amp;和*</div><div class="line">-----------</div><div class="line"></div><div class="line">这里&amp;是取地址运算符，*是...书上叫做&quot;间接运算符&quot;。&amp;a的运算结果是一个指针，指针的类型是a的类型加个*，指针所指向的类型 </div><div class="line">是a的类型，指针所指向的地址嘛，那就是a的地址。*p的运算结果就五花八门了。总之*p的结果是p所指向的东西，这个东西有这 </div><div class="line">些特点：它的类型是p指向的类型，它所占用的地址是p所指向的地址。 </div><div class="line">例五：</div></pre></td></tr></table></figure></p>
<p>int a=12;<br>int b;<br>int <em>p;<br>int **ptr;<br>p=&a;//&amp;a的结果是一个指针，类型是int</em>，指向的类型是int，指向的地址是a的地址。<br><em>p=24;//</em>p的结果，在这里它的类型是int，它所占用的地址是p所指向的地址，显然，<em>p就是变量a。<br>ptr=&p;//&amp;p的结果是个指针，该指针的类型是p的类型加个</em>，在这里是int<strong>。该指针所指向的类型是p的类型，这里是int<em>。该指针所指向的地址就是指针p自己的地址。 
</em>ptr=&b;//<em>ptr是个指针，&amp;b的结果也是个指针，且这两个指针的类型和所指向的类型是一样的，所以用&amp;b来给</em>ptr赋值就是毫无      问题的了。 
</strong>ptr=34;//<em>ptr的结果是ptr所指向的东西，在这里是一个指针，对这个指针再做一次</em>运算，结果就是一个int类型的变量。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">第四章 指针表达式</div><div class="line">---------</div><div class="line"></div><div class="line">一个表达式的最后结果如果是一个指针，那么这个表达式就叫指针表达式。下面是一些指针表达式的例子： </div><div class="line">例六：</div></pre></td></tr></table></figure></p>
<p>int a,b;<br>int array[10];<br>int <em>pa;<br>pa=&a;//&amp;a是一个指针表达式。<br>int **ptr=&pa;//&amp;pa也是一个指针表达式。 
</em>ptr=&b;//*ptr和&amp;b都是指针表达式。<br>pa=array;<br>pa++;//这也是指针表达式。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">例七：</div><div class="line">``` </div><div class="line">char *arr[20]; </div><div class="line">char **parr=arr;//如果把arr看作指针的话，arr也是指针表达式 </div><div class="line">char *str; </div><div class="line">str=*parr;//*parr是指针表达式 </div><div class="line">str=*(parr+1);//*(parr+1)是指针表达式 </div><div class="line">str=*(parr+2);//*(parr+2)是指针表达式</div></pre></td></tr></table></figure></p>
<p>由于指针表达式的结果是一个指针，所以指针表达式也具有指针所具有的四个要素：指针的类型，指针所指向的类型，指针指向的内存区，指针自身占据的内存。好了，当一个指针表达式的结果指针已经明确地具有了指针自身占据的内存的话，这个指针表达式就是一个左值，否则就不是一个左值。<br>在例六中，&amp;a不是一个左值，因为它还没有占据明确的内存。<em>ptr是一个左值，因为</em>ptr这个指针已经占据了内存，其实<em>ptr就是指针pa，既然pa已经在内存中有了自己的位置，那么</em>ptr当然也有了自己的位置。 </p>
<h2 id="第五章-数组和指针的关系"><a href="#第五章-数组和指针的关系" class="headerlink" title="第五章 数组和指针的关系"></a>第五章 数组和指针的关系</h2><p>数组的数组名其实可以看作一个指针。看下例：<br>例八：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">int array[10]=&#123;0,1,2,3,4,5,6,7,8,9&#125;,value; </div><div class="line">... </div><div class="line">... </div><div class="line">value=array[0];//也可写成：value=*array; </div><div class="line">value=array[3];//也可写成：value=*(array+3); </div><div class="line">value=array[4];//也可写成：value=*(array+4);</div><div class="line">``` </div><div class="line">上例中，一般而言数组名array代表数组本身，类型是int [10]，但如果把array看做指针的话，它指向数组的第0个单元，类型是int *，所指向的类型是数组单元的类型即int。因此*array等于0就一点也不奇怪了。同理，array+3是一个指向数组第3个单元的指针，所以*(array+3)等于3。其它依此类推。 </div><div class="line"></div><div class="line">例九： </div><div class="line">``` </div><div class="line">char *str[3]=&#123; </div><div class="line">&quot;Hello,this is a sample!&quot;, </div><div class="line">&quot;Hi,good morning.&quot;, </div><div class="line">&quot;Hello world&quot; </div><div class="line">&#125;; </div><div class="line">char s[80]； </div><div class="line">strcpy(s,str[0]);//也可写成strcpy(s,*str); </div><div class="line">strcpy(s,str[1]);//也可写成strcpy(s,*(str+1)); </div><div class="line">strcpy(s,str[2]);//也可写成strcpy(s,*(str+2));</div></pre></td></tr></table></figure></p>
<p>上例中，str是一个三单元的数组，该数组的每个单元都是一个指针，这些指针各指向一个字符串。把指针数组名str当作一个指针的话，它指向数组的第0号单元，它的类型是char<strong>，它指向的类型是char <em>。</em>str也是一个指针，它的类型是char*，它所指向的类型是char，它指向的地址是字符串”Hello,this is a sample!”的第一个字符的地址，即’H’的地址。str+1也是一个指针，它指向数组的第1号单元，它的类型是char</strong>，它指向的类型是char <em>。 </em>(str+1)也是一个指针，它的类型是char*，它所指向的类型是char，它指向 “Hi,good morning.”的第一个字符’H’，等等。 </p>
<p>下面总结一下数组的数组名的问题。声明了一个数组TYPE array[n]，则数组名称array就有了两重含义：第一，它代表整个数组，它的类型是TYPE [n]；第二，它是一个指针，该指针的类型是TYPE<em>，该指针指向的类型是TYPE，也就是数组单元的类型，该指针指向的内存区就是数组第0号单元，该指针自己占有单独的内存区，注意它和数组第0号单元占据的内存区是不同的。该指针的值是不能修改的，即类似array++的表达式是错误的。<br>在不同的表达式中数组名array可以扮演不同的角色。在表达式sizeof(array)中，数组名array代表数组本身，故这时sizeof函数<br>测出的是整个数组的大小。在表达式</em>array中，array扮演的是指针，因此这个表达式的结果就是数组第 0号单元的值。sizeof(<em>array)测出的是数组单元的大小。 表达式array+n（其中n=0，1，2，….。）中，array扮演的是指针，故arr<br>ay+n的结果是一个指针，它的类型是TYPE</em>，它指向的类型是TYPE，它指向数组第<br>n号单元。故sizeof(array+n)测出的是指针类型的大小。<br>例十：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">int array[10]; </div><div class="line">int (*ptr)[10]; </div><div class="line">ptr=&amp;array;</div></pre></td></tr></table></figure></p>
<p>上例中ptr是一个指针，它的类型是int (*)[10]，他指向的类型是int [10]，我们用整个数组的首地址来初始化它。在语句ptr=&amp;array中，array代表数组本身。 </p>
<p>本节中提到了函数sizeof()，那么我来问一问，sizeof(指针名称)测出的究竟是指针自身类型的大小呢还是指针所指向的类型的大小？答案是前者。例如： </p>
<p>int (*ptr)[10];<br>则在32位程序中，有：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sizeof(int(*)[10])==4 </div><div class="line">sizeof(int [10])==40 </div><div class="line">sizeof(ptr)==4</div></pre></td></tr></table></figure></p>
<p>实际上，sizeof(对象)测出的都是对象自身的类型的大小，而不是别的什么类型的大小。 </p>
<h2 id="第六章-指针和结构类型的关系"><a href="#第六章-指针和结构类型的关系" class="headerlink" title="第六章 指针和结构类型的关系"></a>第六章 指针和结构类型的关系</h2><p>可以声明一个指向结构类型对象的指针。<br>例十一：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">struct MyStruct </div><div class="line">&#123; </div><div class="line">int a; </div><div class="line">int b; </div><div class="line">int c; </div><div class="line">&#125; </div><div class="line">MyStruct ss=&#123;20,30,40&#125;;//声明了结构对象ss，并把ss的三个成员初始化为20，30和40。 </div><div class="line">MyStruct *ptr=&amp;ss;//声明了一个指向结构对象ss的指针。它的类型是MyStruct*,它指向的类型是MyStruct。 </div><div class="line">int *pstr=(int*)&amp;ss;//声明了一个指向结构对象ss的指针。但是它的类型和它指向的类型和ptr是不同的。</div></pre></td></tr></table></figure></p>
<p>请问怎样通过指针ptr来访问ss的三个成员变量？<br>答案：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ptr-&gt;a; </div><div class="line">ptr-&gt;b; </div><div class="line">ptr-&gt;c;</div></pre></td></tr></table></figure></p>
<p>又请问怎样通过指针pstr来访问ss的三个成员变量？<br>答案：<br><em>pstr；//访问了ss的成员a。 
</em>(pstr+1);//访问了ss的成员b。<br><em>(pstr+2)//访问了ss的成员c。<br>呵呵，虽然我在我的MSVC++6.0上调式过上述代码，但是要知道，这样使用pstr来访问结构成员是不正规的，为了说明为什么不正规，让我们看看怎样通过指针来访问数组的各个单元：<br>例十二：<br>int array[3]={35,56,37};<br>int </em>pa=array;<br>通过指针pa访问数组array的三个单元的方法是：<br><em>pa;//访问了第0号单元 
</em>(pa+1);//访问了第1号单元<br><em>(pa+2);//访问了第2号单元<br>从格式上看倒是与通过指针访问结构成员的不正规方法的格式一样。所有的C/C++编译器在排列数组的单元时，总是把各个数组单元存放在连续的存储区里，单元和单元之间没有空隙。但在存放结构对象的各个成员时，在某种编译环境下，可能会需要字对齐或双字对齐或者是别的什么对齐，需要在相邻两个成员之间加若干?quot;填充字节”，这就导致各个成员之间可能会有若干个字节的空隙。<br>所以，在例十二中，即使</em>pstr访问到了结构对象ss的第一个成员变量a，也不能保证<em>(pstr+1)就一定能访问到结构成员b。因为成员a和成员b之间可能会有若干填充字节，说不定</em>(pstr+1)就正好访问到了这些填充字节呢。这也证明了指针的灵活性。要是你的目的就是想看看各个结构成员之间到底有没有填充字节，嘿，这倒是个不错的方法。 通过指针访问结构成员的正确方法应该是象例十二中使用指针ptr的方法。 </p>
<h2 id="第七章-指针和函数的关系"><a href="#第七章-指针和函数的关系" class="headerlink" title="第七章 指针和函数的关系"></a>第七章 指针和函数的关系</h2><p>可以把一个指针声明成为一个指向函数的指针。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">int fun1(char*,int); </div><div class="line">int (*pfun1)(char*,int); </div><div class="line">pfun1=fun1; </div><div class="line">.... </div><div class="line">.... </div><div class="line">int a=(*pfun1)(&quot;abcdefg&quot;,7);//通过函数指针调用函数。</div></pre></td></tr></table></figure></p>
<p>可以把指针作为函数的形参。在函数调用语句中，可以用指针表达式来作为实参。<br>例十三：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">int fun(char*); </div><div class="line">int a; </div><div class="line">char str[]=&quot;abcdefghijklmn&quot;; </div><div class="line">a=fun(str); </div><div class="line">... </div><div class="line">... </div><div class="line">int fun(char*s) </div><div class="line">&#123; </div><div class="line">int num=0; </div><div class="line">for(int i=0;i&lt;strlen(s);i++) </div><div class="line">&#123; </div><div class="line">num+=*s;s++; </div><div class="line">&#125; </div><div class="line">return num; </div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>这个例子中的函数fun统计一个字符串中各个字符的ASCII码值之和。前面说了，数组的名字也是一个指针。在函数调用中，当把str作为实参传递给形参s后，实际是把str的值传递给了s，s所指向的地址就和str所指向的地址一致，但是str和s各自占用各自的存储空间。在函数体内对s进行自加1运算，并不意味着同时对str进行了自加1运算。 </p>
<h2 id="第八章-指针类型转换"><a href="#第八章-指针类型转换" class="headerlink" title="第八章 指针类型转换"></a>第八章 指针类型转换</h2><p>当我们初始化一个指针或给一个指针赋值时，赋值号的左边是一个指针，赋值号的右边是一个指针表达式。在我们前面所举的例子中，绝大多数情况下，指针的类型和指针表达式的类型是一样的，指针所指向的类型和指针表达式所指向的类型是一样的。<br>例十四：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">float f=12.3; </div><div class="line">float *fptr=&amp;f; </div><div class="line">int *p;</div></pre></td></tr></table></figure></p>
<p>在上面的例子中，假如我们想让指针p指向实数f，应该怎么搞？是用下面的语句吗？<br>p=&f;<br>不对。因为指针p的类型是int<em>，它指向的类型是int。表达式&amp;f的结果是一个指针，指针的类型是float</em>,它指向的类型是float。两者不一致，直接赋值的方法是不行的。至少在我的MSVC++6.0上，对指针的赋值语句要求赋值号两边的类型一致，所指向的类型也一致，其它的编译器上我没试过，大家可以试试。为了实现我们的目的，需要进行”强制类型转换”：<br>p=(int<em>)&f;<br>如果有一个指针p，我们需要把它的类型和所指向的类型改为TYEP</em>和TYPE,那么语法格式是：<br>(TYPE<em>)p；<br>这样强制类型转换的结果是一个新指针，该新指针的类型是TYPE</em>，它指向的类型是TYPE，它指向的地址就是原指针指向的地址。而原来的指针p的一切属性都没有被修改。 </p>
<p>一个函数如果使用了指针作为形参，那么在函数调用语句的实参和形参的结合过程中，也会发生指针类型的转换。<br>例十五：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">void fun(char*); </div><div class="line">int a=125,b; </div><div class="line">fun((char*)&amp;a); </div><div class="line">... </div><div class="line">... </div><div class="line">void fun(char*s) </div><div class="line">&#123; </div><div class="line">char c; </div><div class="line">c=*(s+3);*(s+3)=*(s+0);*(s+0)=c; </div><div class="line">c=*(s+2);*(s+2)=*(s+1);*(s+1)=c; </div><div class="line">&#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>注意这是一个32位程序，故int类型占了四个字节，char类型占一个字节。函数fun的作用是把一个整数的四个字节的顺序来个颠倒。注意到了吗？在函数调用语句中，实参&amp;a的结果是一个指针，它的类型是int <em>，它指向的类型是int。形参这个指针的类型是char</em>，它指向的类型是char。这样，在实参和形参的结合过程中，我们必须进行一次从int<em>类型到char</em>类型的转换。结合这个例子，我们可以这样来想象编译器进行转换的过程：编译器先构造一个临时指针 char<em>temp，然后执行temp=(char</em>)&amp;a，最后再把temp的值传递给s。所以最后的结果是：s的类型是char*,它指向的类型是char，它指向的地址就是a的首地址。 </p>
<p>我们已经知道，指针的值就是指针指向的地址，在32位程序中，指针的值其实是一个32位整数。那可不可以把一个整数当作指针的值直接赋给指针呢？就象下面的语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">unsigned int a; </div><div class="line">TYPE *ptr;//TYPE是int，char或结构类型等等类型。 </div><div class="line">... </div><div class="line">... </div><div class="line">a=20345686; </div><div class="line">ptr=20345686;//我们的目的是要使指针ptr指向地址20345686（十进制 </div><div class="line">） </div><div class="line">ptr=a;//我们的目的是要使指针ptr指向地址20345686（十进制）</div></pre></td></tr></table></figure></p>
<p>编译一下吧。结果发现后面两条语句全是错的。那么我们的目的就不能达到了吗？不，还有办法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">unsigned int a; </div><div class="line">TYPE *ptr;//TYPE是int，char或结构类型等等类型。 </div><div class="line">... </div><div class="line">... </div><div class="line">a=某个数，这个数必须代表一个合法的地址； </div><div class="line">ptr=(TYPE*)a；//呵呵，这就可以了。</div></pre></td></tr></table></figure></p>
<p>严格说来这里的(TYPE<em>)和指针类型转换中的(TYPE</em>)还不一样。这里的(TYPE*)的意思是把无符号整数a的值当作一个地址来看待。<br>上面强调了a的值必须代表一个合法的地址，否则的话，在你使用ptr的时候，就会出现非法操作错误。 </p>
<p>想想能不能反过来，把指针指向的地址即指针的值当作一个整数取出来。完全可以。下面的例子演示了把一个指针的值当作一个整数取出来，然后再把这个整数当作一个地址赋给一个指针：<br>例十六：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">int a=123,b; </div><div class="line">int *ptr=&amp;a; </div><div class="line">char *str; </div><div class="line">b=(int)ptr;//把指针ptr的值当作一个整数取出来。 </div><div class="line">str=(char*)b;//把这个整数的值当作一个地址赋给指针str。</div></pre></td></tr></table></figure></p>
<p>好了，现在我们已经知道了，可以把指针的值当作一个整数取出来，也可以把一个整数值当作地址赋给一个指针。 </p>
<h2 id="第九章-指针的安全问题"><a href="#第九章-指针的安全问题" class="headerlink" title="第九章 指针的安全问题"></a>第九章 指针的安全问题</h2><p>看下面的例子：<br>例十七：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">char s=’a’; </div><div class="line">int *ptr; </div><div class="line">ptr=(int*)&amp;s; </div><div class="line">*ptr=1298；</div></pre></td></tr></table></figure></p>
<p>指针ptr是一个int*类型的指针，它指向的类型是int。它指向的地址就是s的首地址。在32位程序中，s占一个字节，int类型占四个字节。最后一条语句不但改变了s所占的一个字节，还把和s相临的高地址方向的三个字节也改变了。这三个字节是干什么的？只有编译程序知道，而写程序的人是不太可能知道的。也许这三个字节里存储了非常重要的数据，也许这三个字节里正好是程序的一条代码，而由于你对指针的马虎应用，这三个字节的值被改变了！这会造成崩溃性的错误。<br>让我们再来看一例：<br>例十八：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">char a; </div><div class="line">int *ptr=&amp;a; </div><div class="line">... </div><div class="line">... </div><div class="line">ptr++; </div><div class="line">*ptr=115;</div></pre></td></tr></table></figure></p>
<p>该例子完全可以通过编译，并能执行。但是看到没有？第3句对指针ptr进行自加1运算后，ptr指向了和整形变量a相邻的高地址方向的一块存储区。这块存储区里是什么？我们不知道。有可能它是一个非常重要的数据，甚至可能是一条代码。而第4句竟然往这片存储区里写入一个数据！这是严重的错误。所以在使用指针时，程序员心里必须非常清楚：我的指针究竟指向了哪里。<br>在用指针访问数组的时候，也要注意不要超出数组的低端和高端界限，否则也会造成类似的错误。<br>在指针的强制类型转换：ptr1=(TYPE*)ptr2中，如果sizeof(ptr2的类型)大于sizeof(ptr1的类型)，那么在使用指针ptr1来访问ptr2所指向的存储区时是安全的。如果sizeof(ptr2的类型)小于sizeof(ptr1的类型)，那么在使用指针ptr1来访问ptr2所指向的存储区时是不安全的。至于为什么，读者结合例十七来想一想，应该会明白的。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C/">C</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/C/">C</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/01/04/other_02/" title="无题" itemprop="url">无题</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ericwang" target="_blank" itemprop="author">ericwang</a>
		
  <p class="article-time">
    <time datetime="2016-01-04T02:55:01.000Z" itemprop="datePublished"> Published 2016-01-04</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>新的一年  心的开始<br>过去一年，工作换了两次，一直都在试用期，过去一年的目标，也完成了不少。<br>参与设计开发了一些比较有规模的java项目，这个应该是完成的最好的了<br>php的框架，一直在学习，心中也有了一些简单框架的雏形<br>php扩展，一直以来，对c还是有些茫然，主要还是指针，不过最近通过书籍，基本熟悉了扩展开发流程，但是C的基础太差，也只能做最简单的开发<br>接下来，也为这一年，定下自己的目标吧<br>首先是C了，接下来的一年，一定要掌握这门语言，为以后打基础<br>接下来是扩展了，写一个基本的扩展<br>然后就是nginx了，了解nginx各模块，以及openrestry<br>就先这些吧，多说无益</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/other/">other</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/12/24/php_05/" title="php socket" itemprop="url">php socket</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ericwang" target="_blank" itemprop="author">ericwang</a>
		
  <p class="article-time">
    <time datetime="2015-12-24T11:11:00.000Z" itemprop="datePublished"> Published 2015-12-24</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>闲了很多天，又不知道写点什么，看书看到了socket这块，还挺有意思，照着书上的模仿了一下，用socket模拟smtp协议发送邮件，邮件服务器是qq的。不过书有点老，qq的邮件服务器必须用https了，所以自己摸索着实现了一下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">/**</div><div class="line"> * Created by PhpStorm.</div><div class="line"> * User: eric</div><div class="line"> * Date: 15/12/24</div><div class="line"> * Time: 上午10:54</div><div class="line"> */</div><div class="line">class Mail&#123;</div><div class="line">    private $sock;</div><div class="line">    private $errorStr;</div><div class="line">    private $errorNo;</div><div class="line">    private $timeout=30;</div><div class="line">    private $host;</div><div class="line">    private $port;</div><div class="line">    private $user;</div><div class="line">    private $password;</div><div class="line">    function __construct($host,$port,$user,$pass,$format=1,$debug=0)&#123;</div><div class="line">        $this-&gt;host = $host;</div><div class="line">        $this-&gt;port = $port;</div><div class="line">        $this-&gt;user = base64_encode($user);</div><div class="line">        $this-&gt;password = base64_encode($pass);</div><div class="line">        $this-&gt;sock = fsockopen($this-&gt;host,$this-&gt;port,$this-&gt;errorNo,$this-&gt;errorStr,$this-&gt;timeout);</div><div class="line">        if(!$this-&gt;sock)&#123;</div><div class="line">            exit(&quot;oops&quot;);</div><div class="line">        &#125;</div><div class="line">        $response  = fgets($this-&gt;sock);</div><div class="line">        if(strstr($response,&apos;220&apos;) === false)&#123;</div><div class="line">            exit(&quot;server error&quot;);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    function showDebug($response,$commond)&#123;</div><div class="line">        echo $commond;</div><div class="line">        echo $response.PHP_EOL;</div><div class="line">    &#125;</div><div class="line">    function doCommond($commond,$return_code)&#123;</div><div class="line">        fwrite($this-&gt;sock,$commond);</div><div class="line">        $response = fgets($this-&gt;sock);</div><div class="line">        if(stristr($response,&quot;$return_code&quot;) == false)&#123;</div><div class="line">            $this-&gt;showDebug($response,$commond);</div><div class="line">            return false;</div><div class="line">        &#125;</div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line">    function sendMail($from,$to,$sub,$body)&#123;</div><div class="line">        $detail = &quot;FROM:&quot;.$from.&quot;\r\n&quot;;</div><div class="line">        $detail.=&quot;To:&quot;.$to.&quot;\r\n&quot;;</div><div class="line">        $detail.=&quot;Subject:&quot;.$sub.&quot;\r\n&quot;;</div><div class="line">        $detail.=&quot;Content-type:text/plain;\r\n\r\n&quot;;</div><div class="line">        $detail.=$body;</div><div class="line">        $this-&gt;doCommond(&quot;HELO smtp.qq.com\r\n&quot;,250);</div><div class="line">        $this-&gt;doCommond(&quot;AUTH LOGIN\r\n&quot;,334);</div><div class="line">        $this-&gt;doCommond($this-&gt;user.&quot;\r\n&quot;,334);</div><div class="line">        $this-&gt;doCommond($this-&gt;password.&quot;\r\n&quot;,235);</div><div class="line">        $this-&gt;doCommond(&quot;MAIL FROM:&quot;.$from.&quot;\r\n&quot;,250);</div><div class="line">        $this-&gt;doCommond(&quot;RCPT TO:&quot;.$to.&quot;\r\n&quot;,250);</div><div class="line">        $this-&gt;doCommond(&quot;DATA\r\n&quot;,354);</div><div class="line">        $this-&gt;doCommond($detail.&quot;\r\n.\r\n&quot;,250);</div><div class="line">        $this-&gt;doCommond(&quot;QUIT\r\n&quot;,221);</div><div class="line">        return true;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$mail  =  new Mail(&apos;ssl://smtp.qq.com&apos;,465,&apos;xxx@qq.com&apos;,&apos;特殊的密码，因为我有邮箱独立密码，所以只能使用qq邮箱额外提供的&apos;);</div><div class="line">$mail-&gt;sendMail(&apos;xxx@qq.com&apos;,&apos;xxxx@qq.com&apos;,&apos;hi&apos;,&apos;嘿嘿嘿&apos;);</div></pre></td></tr></table></figure></p>
<p>因为smtp可以在telnet中模拟，所以想着去模拟一个请求去访问redis也应该是可以的，在没有装redis扩展或者composer依赖的时候，简单的请求可以直接用socket实现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">/**</div><div class="line"> * Created by PhpStorm.</div><div class="line"> * User: eric</div><div class="line"> * Date: 15/12/24</div><div class="line"> * Time: 下午2:15</div><div class="line"> */</div><div class="line">$socket = fsockopen(&apos;127.0.0.1&apos;,6379);</div><div class="line">fwrite($socket,&quot;ping\r\n&quot;);</div><div class="line">$response = fgets($socket);</div><div class="line">echo &quot;&lt;pre&gt;&quot;;print_r($response);</div><div class="line">fwrite($socket,&quot;set a aaa\r\n &quot;);</div><div class="line">$response = fgets($socket);</div><div class="line">echo &quot;&lt;pre&gt;&quot;;print_r($response);</div><div class="line">fwrite($socket,&quot;get a\r\n&quot;);</div><div class="line">$response = fgets($socket);</div><div class="line">echo &quot;&lt;pre&gt;&quot;;print_r($response);</div></pre></td></tr></table></figure></p>
<p>接下来尝试下用php socket搭建一个煎蛋代理服务(因为之前转过了一篇node)</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/php/">php</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/php/">php</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/12/02/redis_02/" title="redis分布式锁" itemprop="url">redis分布式锁</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ericwang" target="_blank" itemprop="author">ericwang</a>
		
  <p class="article-time">
    <time datetime="2015-12-02T01:19:17.000Z" itemprop="datePublished"> Published 2015-12-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>看了<a href="http://ifeve.com/redis-lock/" target="_blank" rel="external">并发编程网的这篇翻译</a>。<br>看了标题，首先想到的是如何实现一个单机锁，因为redis中大多数操作都是原子的，所以想法是：</p>
<ul>
<li>在redis中存在一个key，保证客户端在读到这个key的时候，阻塞</li>
<li>如果一个客户端在读不到的这个key的时候，说明没有客户端持有锁，可以将其上锁</li>
<li>获取到锁的客户端在执行逻辑完后，释放锁</li>
</ul>
<p>redis中的命令刚好有一个这样的命令  setnx。<br>继续看下面的翻译，发现自己的想法过于简单，任何设计都应该遵循design for failure 的原则</p>
<ul>
<li>如果一个客户端在获取到锁后，因为某些原因，down掉了，所有的客户端就永远不会持有锁了</li>
<li>针对上面的情况，可以为这个key设置一个存活时间（但是setnx并不支持存在时间，如果使用expire，不能保证原子性，看了文档，在2.6后续版本中，set已经可以替代setnx了[set的文档]<a href="http://redis.io/commands/set）" target="_blank" rel="external">http://redis.io/commands/set）</a></li>
<li>针对上一条的情况，由于某些因素导致某客户端A获取锁后执行的时间过长，一致于超过了锁的缓存时间，这时又有其他客户端B获取到锁，A执行完成之后，释放锁，这时其他客户端就会获取锁。所以需要为每一个锁设置唯一的value，保证只有持有锁的客户端才能删除它</li>
</ul>
<p>在其他的blog里也看到了类似的想法<a href="http://huoding.com/2015/09/14/463" target="_blank" rel="external">谈谈Redis的SETNX</a></p>
<p>redis作者也给出了<a href="https://github.com/ronnylt/redlock-php" target="_blank" rel="external">代码</a>(php版本)，这里不贴了，分布式版本中，考虑的问题就更多了。<a href="https://github.com/antirez/redis-doc/blob/master/topics/distlock.md" target="_blank" rel="external">原文</a>中，针对分布式中的情况作了很多解释，翻译也有了，就不贴了，不过翻译有的地方是错的，以后还是看原文吧，英语看的慢点，多看几遍，不至于理解错</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/nosql/">nosql</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/redis/">redis</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/11/29/php02/" title="php object2array array2object" itemprop="url">php object2array array2object</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ericwang" target="_blank" itemprop="author">ericwang</a>
		
  <p class="article-time">
    <time datetime="2015-11-29T12:02:00.000Z" itemprop="datePublished"> Published 2015-11-29</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>今天看到有人问php中对象如何转化成数组，想到的第一个方式便是json encode和decode，不过这种方式在性能上会有些问题,因为序列化反序列化始终是个耗时的操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">json_decode(json_encode($object),true)</div></pre></td></tr></table></figure></p>
<p>然后有人说<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(array)$object</div></pre></td></tr></table></figure></p>
<p>就可以转化了，试了一下很神奇，竟然可以。但是当一个对象属性是对象时，没法将该对象的属性也变成一个数组<br>所以还是需要写一个递归函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">function objectToArray($stobject)&#123;</div><div class="line">    $_array = is_object($stobject) ? get_object_vars($stobject) : $stobject;</div><div class="line">    if(is_array($_array))&#123;</div><div class="line">    foreach ($_array as $key =&gt; $value) &#123;</div><div class="line">        $value = (is_array($value) || is_object($value)) ? objectToArray($value) : $value;</div><div class="line">        $array[$key] = $value;</div><div class="line">    &#125;&#125;</div><div class="line">    return $array;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>array2object也是同样的道理，如果比较懒，可以直接使用json的方式</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/php/">php</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/php/">php</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/11/23/mac/" title="mac 关闭apache开机启动" itemprop="url">mac 关闭apache开机启动</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ericwang" target="_blank" itemprop="author">ericwang</a>
		
  <p class="article-time">
    <time datetime="2015-11-23T09:20:00.000Z" itemprop="datePublished"> Published 2015-11-23</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>虽然mac常以待机状态恢复基本不关机，不过有时候会死机。<br>现在常用nginx作为php的应用服务器，而且反向代理nginx使用起来比较方便。<br>所以需要关闭apache，释放80端口，使用nginx</p>
<p>mac os不像linux有/etc/init.d/rc.local以及service的方式可以设置程序随机启动，而是使用plist文件管理。</p>
<p>apache的plist文件在/System/Library/LaunchDaemons目录下,文件名是org.apache.httpd.plist</p>
<p>launchctl 管理OS X的启动脚本，控制启动计算机时需要开启的服务。也可以设置定时执行特定任务的脚本，就像Linux cron一样。</p>
<p>Launchd脚本存储在以下位置：</p>
<pre><code>~/Library/LaunchAgents    
/Library/LaunchAgents          
/Library/LaunchDaemons
/System/Library/LaunchAgents
/System/Library/LaunchDaemons
</code></pre><p>可以使用 <code>launchctl list |grep apache</code> 查看是否开机启动apache<br>关闭开机启动</p>
<pre><code>sudo launchctl unload  -w /System/Library/LaunchDaemons/org.apache.httpd.plist
</code></pre><p>然而这并没有完，使用/usr/sbin/apachectl启动apache的时候，apache依旧会重新开机启动，原因是/usr/sbin/apachectl这个脚本里，使用的是launchctl load来启动的，它会把它加入到启动项里，解决办法就是自己写一个httpd的启动关闭脚本,直接启动httpd</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/other/">other</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/3/"><span></span>Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/5/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  
  <div class="tagcloudlist">
    <p class="asidetitle">Tag Cloud</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/C/" style="font-size: 13.33px;">C</a> <a href="/tags/ansible/" style="font-size: 10px;">ansible</a> <a href="/tags/arch/" style="font-size: 10px;">arch</a> <a href="/tags/bower/" style="font-size: 10px;">bower</a> <a href="/tags/c/" style="font-size: 10px;">c</a> <a href="/tags/docker/" style="font-size: 13.33px;">docker</a> <a href="/tags/elasticsearch/" style="font-size: 10px;">elasticsearch</a> <a href="/tags/git/" style="font-size: 11.67px;">git</a> <a href="/tags/http/" style="font-size: 13.33px;">http</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/laravel/" style="font-size: 10px;">laravel</a> <a href="/tags/linux/" style="font-size: 18.33px;">linux</a> <a href="/tags/maven/" style="font-size: 10px;">maven</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/nodejs/" style="font-size: 11.67px;">nodejs</a> <a href="/tags/patterns/" style="font-size: 10px;">patterns</a> <a href="/tags/php/" style="font-size: 20px;">php</a> <a href="/tags/rabbitmq/" style="font-size: 11.67px;">rabbitmq</a> <a href="/tags/redis/" style="font-size: 13.33px;">redis</a> <a href="/tags/rpc/" style="font-size: 10px;">rpc</a> <a href="/tags/shell/" style="font-size: 16.67px;">shell</a> <a href="/tags/singleton/" style="font-size: 10px;">singleton</a> <a href="/tags/solr/" style="font-size: 10px;">solr</a> <a href="/tags/urlencode/" style="font-size: 10px;">urlencode</a> <a href="/tags/varnish/" style="font-size: 10px;">varnish</a> <a href="/tags/数据结构/" style="font-size: 10px;">数据结构</a>
    </div>
  </div>


  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/C/" title="C">C<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/arch/" title="arch">arch<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/books/" title="books">books<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/docker/" title="docker">docker<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/git/" title="git">git<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/http/" title="http">http<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/java/" title="java">java<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/limux/" title="limux">limux<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/linux/" title="linux">linux<sup>19</sup></a></li>
		  
		
		  
			<li><a href="/categories/mysql/" title="mysql">mysql<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/nginx/" title="nginx">nginx<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/nodejs/" title="nodejs">nodejs<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/nosql/" title="nosql">nosql<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/other/" title="other">other<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/categories/patterns/" title="patterns">patterns<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/php/" title="php">php<sup>12</sup></a></li>
		  
		
		  
			<li><a href="/categories/shell/" title="shell">shell<sup>1</sup></a></li>
		  
		
		</ul>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello <br/>
			This is my blog.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2017 
		
		<a href="/about" target="_blank" title="ericwang">ericwang</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-47898532-4', 'auto');  
ga('send', 'pageview');
</script>





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
